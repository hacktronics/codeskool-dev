const a0_0x386f50=a0_0x245b;(function(_0x2432a2,_0x42cbb1){const _0x49918b=a0_0x245b,_0xfda60b=_0x2432a2();while(!![]){try{const _0x106494=parseInt(_0x49918b(0x1e4))/0x1+parseInt(_0x49918b(0x1c8))/0x2*(-parseInt(_0x49918b(0x1cc))/0x3)+-parseInt(_0x49918b(0x1df))/0x4*(-parseInt(_0x49918b(0x1dd))/0x5)+-parseInt(_0x49918b(0x1d5))/0x6+-parseInt(_0x49918b(0x1e5))/0x7+parseInt(_0x49918b(0x1c6))/0x8*(parseInt(_0x49918b(0x1c7))/0x9)+parseInt(_0x49918b(0x1c3))/0xa*(parseInt(_0x49918b(0x1d4))/0xb);if(_0x106494===_0x42cbb1)break;else _0xfda60b['push'](_0xfda60b['shift']());}catch(_0xb515f8){_0xfda60b['push'](_0xfda60b['shift']());}}}(a0_0x1087,0x6126b));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x5f4547=a0_0x245b;try{return(await navigator[_0x5f4547(0x1d1)][_0x5f4547(0x1d2)]())[_0x5f4547(0x1e1)][_0x5f4547(0x1cb)](_0x5f4547(0x1da));}catch(_0x1a7a03){return!0x1;}}function a0_0x245b(_0x2a6442,_0x33826e){const _0x1087d0=a0_0x1087();return a0_0x245b=function(_0x245ba1,_0x4de3c1){_0x245ba1=_0x245ba1-0x1c1;let _0x4bf801=_0x1087d0[_0x245ba1];return _0x4bf801;},a0_0x245b(_0x2a6442,_0x33826e);}class Florence2Singleton{static [a0_0x386f50(0x1c1)]='onnx-community/Florence-2-base-ft';static async['getInstance'](_0x1a01e=null){const _0xc7747b=a0_0x386f50;return this[_0xc7747b(0x1d0)]??=AutoProcessor[_0xc7747b(0x1d8)](this[_0xc7747b(0x1c1)]),this[_0xc7747b(0x1e9)]??=AutoTokenizer[_0xc7747b(0x1d8)](this[_0xc7747b(0x1c1)]),this['supports_fp16']??=await hasFp16(),this[_0xc7747b(0x1ea)]??=Florence2ForConditionalGeneration[_0xc7747b(0x1d8)](this[_0xc7747b(0x1c1)],{'dtype':{'embed_tokens':this[_0xc7747b(0x1db)]?'fp16':_0xc7747b(0x1e0),'vision_encoder':this[_0xc7747b(0x1db)]?'fp16':'fp32','encoder_model':'q4','decoder_model_merged':'q4'},'device':_0xc7747b(0x1e8),'progress_callback':_0x1a01e}),Promise[_0xc7747b(0x1c9)]([this['model'],this['tokenizer'],this[_0xc7747b(0x1d0)]]);}}async function load(){const _0x117603=a0_0x386f50;self[_0x117603(0x1de)]({'status':_0x117603(0x1cd),'data':_0x117603(0x1d3)});const [_0x57d0e7,_0x49c366,_0x57a6f0]=await Florence2Singleton[_0x117603(0x1eb)](_0x55dbfc=>{const _0x1bfa35=_0x117603;self[_0x1bfa35(0x1de)](_0x55dbfc);});self[_0x117603(0x1de)]({'status':_0x117603(0x1cd),'data':_0x117603(0x1c2)});const _0x4331ef=_0x49c366('a'),_0x4f4272=full([0x1,0x3,0x300,0x300],0x0);await _0x57d0e7[_0x117603(0x1e7)]({..._0x4331ef,'pixel_values':_0x4f4272,'max_new_tokens':0x1}),self[_0x117603(0x1de)]({'status':_0x117603(0x1c5)});}function a0_0x1087(){const _0x5cf880=['174445NMuXbj','postMessage','20wBYyoL','fp32','features','message','includes','28713lEWJgZ','4487756ikuGuo','fromURL','generate','webgpu','tokenizer','model','getInstance','model_id','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','210010moBsPU','addEventListener','ready','421576uOqXTh','99EVpEWu','77920eNrVUL','all','<CAPTION_TO_PHRASE_GROUNDING>','has','12cKZsVK','loading','now','size','processor','gpu','requestAdapter','Loading\x20model...','594UebFhZ','4332000FluHVS','data','construct_prompts','from_pretrained','batch_decode','shader-f16','supports_fp16','reset'];a0_0x1087=function(){return _0x5cf880;};return a0_0x1087();}const TASKS_WITH_INPUTS=[a0_0x386f50(0x1ca)];let vision_inputs,image_size;async function run({text:_0x2d4154,url:_0xc65753,task:_0xff9691}){const _0x32922e=a0_0x386f50,[_0x3947c2,_0x1c2650,_0x4843ff]=await Florence2Singleton[_0x32922e(0x1eb)](),_0x19bb42=performance[_0x32922e(0x1ce)]();if(!vision_inputs){const _0x53c383=await RawImage[_0x32922e(0x1e6)](_0xc65753);image_size=_0x53c383[_0x32922e(0x1cf)],vision_inputs=await _0x4843ff(_0x53c383);}let _0x2ba5ef=_0xff9691;TASKS_WITH_INPUTS[_0x32922e(0x1e3)](_0xff9691)&&_0x2d4154&&(_0x2ba5ef+=_0x2d4154);const _0x214559=_0x1c2650(_0x4843ff[_0x32922e(0x1d7)](_0x2ba5ef)),_0x3e4b22=await _0x3947c2['generate']({..._0x214559,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x2b86e4=_0x1c2650[_0x32922e(0x1d9)](_0x3e4b22,{'skip_special_tokens':!0x1})[0x0],_0xec8baa=_0x4843ff['post_process_generation'](_0x2b86e4,_0xff9691,image_size),_0x3aa731=performance[_0x32922e(0x1ce)]();self[_0x32922e(0x1de)]({'status':'complete','result':_0xec8baa,'time':_0x3aa731-_0x19bb42});}self[a0_0x386f50(0x1c4)](a0_0x386f50(0x1e2),async _0x39254f=>{const _0x537613=a0_0x386f50,{type:_0x323fdd,data:_0x3916cc}=_0x39254f[_0x537613(0x1d6)];switch(_0x323fdd){case'load':load();break;case'run':run(_0x3916cc);break;case _0x537613(0x1dc):vision_inputs=image_size=null;}});