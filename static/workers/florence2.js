function a0_0x1b0d(){const _0x3f1ecc=['postMessage','message','reset','ready','tokenizer','fromURL','data','932MCZCcF','run','supports_fp16','Loading\x20model...','has','addEventListener','post_process_generation','2501763RSrgbg','load','fp32','requestAdapter','now','38943dXgrUa','2094364bnnwkX','batch_decode','generate','onnx-community/Florence-2-base-ft','<CAPTION_TO_PHRASE_GROUNDING>','566doftIq','gpu','size','5561210Cdgdpn','fp16','from_pretrained','getInstance','7NoIpnn','features','loading','model','all','model_id','construct_prompts','4390ncmZsU','3398502RQOrUk','5465168AkevGq','includes','complete'];a0_0x1b0d=function(){return _0x3f1ecc;};return a0_0x1b0d();}const a0_0x21c2ba=a0_0x5f42;(function(_0x68bc97,_0x84e62){const _0x4f95d4=a0_0x5f42,_0x11425e=_0x68bc97();while(!![]){try{const _0x92f253=-parseInt(_0x4f95d4(0xf8))/0x1*(-parseInt(_0x4f95d4(0xe6))/0x2)+parseInt(_0x4f95d4(0xed))/0x3+parseInt(_0x4f95d4(0xf3))/0x4+parseInt(_0x4f95d4(0xfb))/0x5+parseInt(_0x4f95d4(0xdb))/0x6*(-parseInt(_0x4f95d4(0xff))/0x7)+parseInt(_0x4f95d4(0xdc))/0x8+parseInt(_0x4f95d4(0xf2))/0x9*(-parseInt(_0x4f95d4(0xda))/0xa);if(_0x92f253===_0x84e62)break;else _0x11425e['push'](_0x11425e['shift']());}catch(_0x55966d){_0x11425e['push'](_0x11425e['shift']());}}}(a0_0x1b0d,0xe819e));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';function a0_0x5f42(_0x10a658,_0x567208){const _0x1b0d95=a0_0x1b0d();return a0_0x5f42=function(_0x5f4297,_0x323713){_0x5f4297=_0x5f4297-0xd8;let _0x169f32=_0x1b0d95[_0x5f4297];return _0x169f32;},a0_0x5f42(_0x10a658,_0x567208);}async function hasFp16(){const _0x3c30be=a0_0x5f42;try{return(await navigator[_0x3c30be(0xf9)][_0x3c30be(0xf0)]())[_0x3c30be(0x100)][_0x3c30be(0xea)]('shader-f16');}catch(_0x174bad){return!0x1;}}class Florence2Singleton{static [a0_0x21c2ba(0xd8)]=a0_0x21c2ba(0xf6);static async['getInstance'](_0x476df6=null){const _0x40da05=a0_0x21c2ba;return this['processor']??=AutoProcessor[_0x40da05(0xfd)](this[_0x40da05(0xd8)]),this[_0x40da05(0xe3)]??=AutoTokenizer[_0x40da05(0xfd)](this[_0x40da05(0xd8)]),this[_0x40da05(0xe8)]??=await hasFp16(),this[_0x40da05(0x102)]??=Florence2ForConditionalGeneration[_0x40da05(0xfd)](this[_0x40da05(0xd8)],{'dtype':{'embed_tokens':this[_0x40da05(0xe8)]?_0x40da05(0xfc):'fp32','vision_encoder':this['supports_fp16']?'fp16':_0x40da05(0xef),'encoder_model':'q4','decoder_model_merged':'q4'},'device':'webgpu','progress_callback':_0x476df6}),Promise[_0x40da05(0x103)]([this[_0x40da05(0x102)],this[_0x40da05(0xe3)],this['processor']]);}}async function load(){const _0x51fbc2=a0_0x21c2ba;self[_0x51fbc2(0xdf)]({'status':_0x51fbc2(0x101),'data':_0x51fbc2(0xe9)});const [_0x277f82,_0x1c2654,_0x326cb6]=await Florence2Singleton[_0x51fbc2(0xfe)](_0x58c140=>{const _0x22186f=_0x51fbc2;self[_0x22186f(0xdf)](_0x58c140);});self[_0x51fbc2(0xdf)]({'status':_0x51fbc2(0x101),'data':'Compiling\x20shaders\x20and\x20warming\x20up\x20model...'});const _0x53c0ee=_0x1c2654('a'),_0x45b6d8=full([0x1,0x3,0x300,0x300],0x0);await _0x277f82[_0x51fbc2(0xf5)]({..._0x53c0ee,'pixel_values':_0x45b6d8,'max_new_tokens':0x1}),self['postMessage']({'status':_0x51fbc2(0xe2)});}const TASKS_WITH_INPUTS=[a0_0x21c2ba(0xf7)];let vision_inputs,image_size;async function run({text:_0xeee5c7,url:_0x5e6c1a,task:_0x5f3c65}){const _0x4043b4=a0_0x21c2ba,[_0x5cedbb,_0x3457e4,_0x39db20]=await Florence2Singleton[_0x4043b4(0xfe)](),_0xf7ee93=performance[_0x4043b4(0xf1)]();if(!vision_inputs){const _0xa9617c=await RawImage[_0x4043b4(0xe4)](_0x5e6c1a);image_size=_0xa9617c[_0x4043b4(0xfa)],vision_inputs=await _0x39db20(_0xa9617c);}let _0x1445cd=_0x5f3c65;TASKS_WITH_INPUTS[_0x4043b4(0xdd)](_0x5f3c65)&&_0xeee5c7&&(_0x1445cd+=_0xeee5c7);const _0x3e4dfc=_0x3457e4(_0x39db20[_0x4043b4(0xd9)](_0x1445cd)),_0x6457be=await _0x5cedbb[_0x4043b4(0xf5)]({..._0x3e4dfc,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x35ea91=_0x3457e4[_0x4043b4(0xf4)](_0x6457be,{'skip_special_tokens':!0x1})[0x0],_0x5b14b0=_0x39db20[_0x4043b4(0xec)](_0x35ea91,_0x5f3c65,image_size),_0x15c857=performance[_0x4043b4(0xf1)]();self[_0x4043b4(0xdf)]({'status':_0x4043b4(0xde),'result':_0x5b14b0,'time':_0x15c857-_0xf7ee93});}self[a0_0x21c2ba(0xeb)](a0_0x21c2ba(0xe0),async _0x10d481=>{const _0x3ad1a5=a0_0x21c2ba,{type:_0x1b9637,data:_0x2c58d7}=_0x10d481[_0x3ad1a5(0xe5)];switch(_0x1b9637){case _0x3ad1a5(0xee):load();break;case _0x3ad1a5(0xe7):run(_0x2c58d7);break;case _0x3ad1a5(0xe1):vision_inputs=image_size=null;}});