const a0_0x18cb16=a0_0x22a5;(function(_0x5a8917,_0x48aa8f){const _0x181389=a0_0x22a5,_0x3cf303=_0x5a8917();while(!![]){try{const _0x5e7019=parseInt(_0x181389(0xef))/0x1+-parseInt(_0x181389(0xf7))/0x2*(-parseInt(_0x181389(0xf3))/0x3)+parseInt(_0x181389(0xed))/0x4+-parseInt(_0x181389(0xe0))/0x5+-parseInt(_0x181389(0xf4))/0x6*(-parseInt(_0x181389(0xdf))/0x7)+-parseInt(_0x181389(0x101))/0x8*(parseInt(_0x181389(0x104))/0x9)+-parseInt(_0x181389(0x100))/0xa*(-parseInt(_0x181389(0xea))/0xb);if(_0x5e7019===_0x48aa8f)break;else _0x3cf303['push'](_0x3cf303['shift']());}catch(_0x23f153){_0x3cf303['push'](_0x3cf303['shift']());}}}(a0_0x1b29,0x6f176));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0xa4739a=a0_0x22a5;try{return(await navigator[_0xa4739a(0xfb)][_0xa4739a(0xf6)]())[_0xa4739a(0xe4)][_0xa4739a(0x105)](_0xa4739a(0xe1));}catch(_0x56d6e8){return!0x1;}}class Florence2Singleton{static [a0_0x18cb16(0xe2)]='onnx-community/Florence-2-base-ft';static async['getInstance'](_0x591f52=null){const _0x22f352=a0_0x18cb16;return this['processor']??=AutoProcessor[_0x22f352(0x102)](this[_0x22f352(0xe2)]),this['tokenizer']??=AutoTokenizer[_0x22f352(0x102)](this['model_id']),this[_0x22f352(0xfc)]??=await hasFp16(),this[_0x22f352(0xe6)]??=Florence2ForConditionalGeneration[_0x22f352(0x102)](this[_0x22f352(0xe2)],{'dtype':{'embed_tokens':this['supports_fp16']?'fp16':_0x22f352(0xeb),'vision_encoder':this[_0x22f352(0xfc)]?'fp16':_0x22f352(0xeb),'encoder_model':'q4','decoder_model_merged':'q4'},'device':'webgpu','progress_callback':_0x591f52}),Promise[_0x22f352(0xfe)]([this['model'],this[_0x22f352(0xff)],this[_0x22f352(0x108)]]);}}async function load(){const _0xd915ad=a0_0x18cb16;self[_0xd915ad(0x106)]({'status':_0xd915ad(0xf2),'data':_0xd915ad(0xfd)});const [_0x332bc0,_0x5dce11,_0x290f2b]=await Florence2Singleton[_0xd915ad(0xfa)](_0x4494e1=>{const _0x3b370e=_0xd915ad;self[_0x3b370e(0x106)](_0x4494e1);});self[_0xd915ad(0x106)]({'status':_0xd915ad(0xf2),'data':'Compiling\x20shaders\x20and\x20warming\x20up\x20model...'});const _0x51daac=_0x5dce11('a'),_0x433fe8=full([0x1,0x3,0x300,0x300],0x0);await _0x332bc0[_0xd915ad(0xf1)]({..._0x51daac,'pixel_values':_0x433fe8,'max_new_tokens':0x1}),self[_0xd915ad(0x106)]({'status':_0xd915ad(0x103)});}const TASKS_WITH_INPUTS=[a0_0x18cb16(0xf5)];function a0_0x1b29(){const _0x145545=['reset','getInstance','gpu','supports_fp16','Loading\x20model...','all','tokenizer','3110dtKeLh','112sfmhBP','from_pretrained','ready','423909ftaDly','has','postMessage','fromURL','processor','2631713cWNRVV','1115810kghzKI','shader-f16','model_id','size','features','message','model','post_process_generation','includes','data','8987svbIeA','fp32','construct_prompts','21688ZfQJQb','run','589559UYmZOe','batch_decode','generate','loading','309gEfBTP','6aFixOM','<CAPTION_TO_PHRASE_GROUNDING>','requestAdapter','2186Gselci','load'];a0_0x1b29=function(){return _0x145545;};return a0_0x1b29();}function a0_0x22a5(_0xa28303,_0x1e4965){const _0x1b29b9=a0_0x1b29();return a0_0x22a5=function(_0x22a5ac,_0x1a871c){_0x22a5ac=_0x22a5ac-0xdf;let _0x400c6c=_0x1b29b9[_0x22a5ac];return _0x400c6c;},a0_0x22a5(_0xa28303,_0x1e4965);}let vision_inputs,image_size;async function run({text:_0x3e6787,url:_0x4e33e3,task:_0x11749d}){const _0x3e2e22=a0_0x18cb16,[_0x2ec74c,_0x22a42b,_0x33dda5]=await Florence2Singleton[_0x3e2e22(0xfa)](),_0x20112c=performance['now']();if(!vision_inputs){const _0x2bd452=await RawImage[_0x3e2e22(0x107)](_0x4e33e3);image_size=_0x2bd452[_0x3e2e22(0xe3)],vision_inputs=await _0x33dda5(_0x2bd452);}let _0x236c46=_0x11749d;TASKS_WITH_INPUTS[_0x3e2e22(0xe8)](_0x11749d)&&_0x3e6787&&(_0x236c46+=_0x3e6787);const _0x4dc1f5=_0x22a42b(_0x33dda5[_0x3e2e22(0xec)](_0x236c46)),_0x5eefde=await _0x2ec74c['generate']({..._0x4dc1f5,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x57d9dc=_0x22a42b[_0x3e2e22(0xf0)](_0x5eefde,{'skip_special_tokens':!0x1})[0x0],_0x9f5391=_0x33dda5[_0x3e2e22(0xe7)](_0x57d9dc,_0x11749d,image_size),_0x274e46=performance['now']();self['postMessage']({'status':'complete','result':_0x9f5391,'time':_0x274e46-_0x20112c});}self['addEventListener'](a0_0x18cb16(0xe5),async _0x21d17c=>{const _0x2a4369=a0_0x18cb16,{type:_0x478590,data:_0x4f2bc7}=_0x21d17c[_0x2a4369(0xe9)];switch(_0x478590){case _0x2a4369(0xf8):load();break;case _0x2a4369(0xee):run(_0x4f2bc7);break;case _0x2a4369(0xf9):vision_inputs=image_size=null;}});