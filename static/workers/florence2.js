function a0_0x2e3e(_0x4feb00,_0x3045ae){const _0x3445ea=a0_0x3445();return a0_0x2e3e=function(_0x2e3ec1,_0x14078c){_0x2e3ec1=_0x2e3ec1-0xd7;let _0x11e795=_0x3445ea[_0x2e3ec1];return _0x11e795;},a0_0x2e3e(_0x4feb00,_0x3045ae);}const a0_0x17c971=a0_0x2e3e;(function(_0x393591,_0x5a41cd){const _0x2fa3cc=a0_0x2e3e,_0x2a1923=_0x393591();while(!![]){try{const _0x10e153=parseInt(_0x2fa3cc(0xe0))/0x1+parseInt(_0x2fa3cc(0xe7))/0x2*(parseInt(_0x2fa3cc(0xf8))/0x3)+parseInt(_0x2fa3cc(0xdd))/0x4*(parseInt(_0x2fa3cc(0xf2))/0x5)+-parseInt(_0x2fa3cc(0x103))/0x6+parseInt(_0x2fa3cc(0xda))/0x7+-parseInt(_0x2fa3cc(0xd9))/0x8+-parseInt(_0x2fa3cc(0xe1))/0x9*(parseInt(_0x2fa3cc(0xf6))/0xa);if(_0x10e153===_0x5a41cd)break;else _0x2a1923['push'](_0x2a1923['shift']());}catch(_0x37466b){_0x2a1923['push'](_0x2a1923['shift']());}}}(a0_0x3445,0x3a16d));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x8cb6d=a0_0x2e3e;try{return(await navigator[_0x8cb6d(0xe6)][_0x8cb6d(0xf4)]())[_0x8cb6d(0xd8)]['has'](_0x8cb6d(0xe4));}catch(_0x55fdb1){return!0x1;}}class Florence2Singleton{static [a0_0x17c971(0xf1)]='onnx-community/Florence-2-base-ft';static async[a0_0x17c971(0x100)](_0x226c65=null){const _0x5c3678=a0_0x17c971;return this[_0x5c3678(0xd7)]??=AutoProcessor[_0x5c3678(0xe3)](this['model_id']),this['tokenizer']??=AutoTokenizer[_0x5c3678(0xe3)](this[_0x5c3678(0xf1)]),this[_0x5c3678(0xe5)]??=await hasFp16(),this[_0x5c3678(0xdb)]??=Florence2ForConditionalGeneration[_0x5c3678(0xe3)](this[_0x5c3678(0xf1)],{'dtype':{'embed_tokens':this[_0x5c3678(0xe5)]?_0x5c3678(0xfa):'fp32','vision_encoder':this['supports_fp16']?_0x5c3678(0xfa):_0x5c3678(0xfe),'encoder_model':'q4','decoder_model_merged':'q4'},'device':_0x5c3678(0xf5),'progress_callback':_0x226c65}),Promise[_0x5c3678(0xfb)]([this[_0x5c3678(0xdb)],this['tokenizer'],this[_0x5c3678(0xd7)]]);}}async function load(){const _0x39479b=a0_0x17c971;self[_0x39479b(0xfc)]({'status':_0x39479b(0xec),'data':_0x39479b(0xef)});const [_0x366e7d,_0x1b941c,_0x1b94e8]=await Florence2Singleton['getInstance'](_0x493839=>{const _0x18cb3e=_0x39479b;self[_0x18cb3e(0xfc)](_0x493839);});self['postMessage']({'status':'loading','data':_0x39479b(0xed)});const _0x2ccfeb=_0x1b941c('a'),_0x5c5c17=full([0x1,0x3,0x300,0x300],0x0);await _0x366e7d[_0x39479b(0xdf)]({..._0x2ccfeb,'pixel_values':_0x5c5c17,'max_new_tokens':0x1}),self[_0x39479b(0xfc)]({'status':_0x39479b(0xee)});}function a0_0x3445(){const _0x5652ff=['fp16','all','postMessage','includes','fp32','now','getInstance','size','fromURL','2771046FXCpsA','processor','features','2750472Fpglfh','2984541JxGFwI','model','run','117044okhkly','construct_prompts','generate','207581AZfQSp','47529VdwvYP','complete','from_pretrained','shader-f16','supports_fp16','gpu','122XSrRdP','batch_decode','reset','<CAPTION_TO_PHRASE_GROUNDING>','data','loading','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','ready','Loading\x20model...','post_process_generation','model_id','65lBaDvk','load','requestAdapter','webgpu','550AXoXdb','addEventListener','15723clGQfv','message'];a0_0x3445=function(){return _0x5652ff;};return a0_0x3445();}const TASKS_WITH_INPUTS=[a0_0x17c971(0xea)];let vision_inputs,image_size;async function run({text:_0x2395c2,url:_0x548b46,task:_0x4fbcf4}){const _0x5ba7d7=a0_0x17c971,[_0x2681b8,_0x557d70,_0x1ed91b]=await Florence2Singleton[_0x5ba7d7(0x100)](),_0x5a9f78=performance[_0x5ba7d7(0xff)]();if(!vision_inputs){const _0x416f85=await RawImage[_0x5ba7d7(0x102)](_0x548b46);image_size=_0x416f85[_0x5ba7d7(0x101)],vision_inputs=await _0x1ed91b(_0x416f85);}let _0x2c45c2=_0x4fbcf4;TASKS_WITH_INPUTS[_0x5ba7d7(0xfd)](_0x4fbcf4)&&_0x2395c2&&(_0x2c45c2+=_0x2395c2);const _0x383ddd=_0x557d70(_0x1ed91b[_0x5ba7d7(0xde)](_0x2c45c2)),_0x561453=await _0x2681b8['generate']({..._0x383ddd,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x593f70=_0x557d70[_0x5ba7d7(0xe8)](_0x561453,{'skip_special_tokens':!0x1})[0x0],_0x10e4a2=_0x1ed91b[_0x5ba7d7(0xf0)](_0x593f70,_0x4fbcf4,image_size),_0x43eeae=performance[_0x5ba7d7(0xff)]();self['postMessage']({'status':_0x5ba7d7(0xe2),'result':_0x10e4a2,'time':_0x43eeae-_0x5a9f78});}self[a0_0x17c971(0xf7)](a0_0x17c971(0xf9),async _0x376f09=>{const _0x549c3f=a0_0x17c971,{type:_0x3dfde6,data:_0x57875c}=_0x376f09[_0x549c3f(0xeb)];switch(_0x3dfde6){case _0x549c3f(0xf3):load();break;case _0x549c3f(0xdc):run(_0x57875c);break;case _0x549c3f(0xe9):vision_inputs=image_size=null;}});