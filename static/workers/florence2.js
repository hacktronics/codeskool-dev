function a0_0xa560(_0x563af0,_0x288be5){const _0x334551=a0_0x3345();return a0_0xa560=function(_0xa5600d,_0x50c6c6){_0xa5600d=_0xa5600d-0x13d;let _0x1938df=_0x334551[_0xa5600d];return _0x1938df;},a0_0xa560(_0x563af0,_0x288be5);}function a0_0x3345(){const _0x97b831=['<CAPTION_TO_PHRASE_GROUNDING>','postMessage','onnx-community/Florence-2-base-ft','has','3036669Focrsq','includes','10AZiGwU','model','tokenizer','4poVKPA','size','all','5160680DtQgkZ','message','model_id','gpu','webgpu','8267oaJmiA','4819536itRznN','from_pretrained','construct_prompts','now','complete','batch_decode','run','26487747tJCixf','376FYGtrc','fp32','requestAdapter','loading','supports_fp16','processor','85981hXqHxk','888bSZYSN','generate','fromURL','fp16','shader-f16','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','getInstance','5903217RbfOEp','load'];a0_0x3345=function(){return _0x97b831;};return a0_0x3345();}const a0_0x4ef833=a0_0xa560;(function(_0x408464,_0xa4d3d4){const _0x2eda30=a0_0xa560,_0x5bb9b1=_0x408464();while(!![]){try{const _0x276ea2=-parseInt(_0x2eda30(0x14f))/0x1*(parseInt(_0x2eda30(0x158))/0x2)+parseInt(_0x2eda30(0x142))/0x3*(parseInt(_0x2eda30(0x147))/0x4)+-parseInt(_0x2eda30(0x14a))/0x5+parseInt(_0x2eda30(0x150))/0x6+parseInt(_0x2eda30(0x15e))/0x7*(-parseInt(_0x2eda30(0x15f))/0x8)+parseInt(_0x2eda30(0x166))/0x9*(parseInt(_0x2eda30(0x144))/0xa)+parseInt(_0x2eda30(0x157))/0xb;if(_0x276ea2===_0xa4d3d4)break;else _0x5bb9b1['push'](_0x5bb9b1['shift']());}catch(_0x2900c4){_0x5bb9b1['push'](_0x5bb9b1['shift']());}}}(a0_0x3345,0xe2f58));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x7b430c=a0_0xa560;try{return(await navigator[_0x7b430c(0x14d)][_0x7b430c(0x15a)]())['features'][_0x7b430c(0x141)](_0x7b430c(0x163));}catch(_0x185724){return!0x1;}}class Florence2Singleton{static [a0_0x4ef833(0x14c)]=a0_0x4ef833(0x140);static async['getInstance'](_0x543cee=null){const _0x21f0fc=a0_0x4ef833;return this[_0x21f0fc(0x15d)]??=AutoProcessor[_0x21f0fc(0x151)](this[_0x21f0fc(0x14c)]),this[_0x21f0fc(0x146)]??=AutoTokenizer['from_pretrained'](this[_0x21f0fc(0x14c)]),this['supports_fp16']??=await hasFp16(),this[_0x21f0fc(0x145)]??=Florence2ForConditionalGeneration[_0x21f0fc(0x151)](this[_0x21f0fc(0x14c)],{'dtype':{'embed_tokens':this[_0x21f0fc(0x15c)]?_0x21f0fc(0x162):'fp32','vision_encoder':this[_0x21f0fc(0x15c)]?'fp16':_0x21f0fc(0x159),'encoder_model':'q4','decoder_model_merged':'q4'},'device':_0x21f0fc(0x14e),'progress_callback':_0x543cee}),Promise[_0x21f0fc(0x149)]([this['model'],this[_0x21f0fc(0x146)],this[_0x21f0fc(0x15d)]]);}}async function load(){const _0xf58039=a0_0x4ef833;self[_0xf58039(0x13f)]({'status':_0xf58039(0x15b),'data':'Loading\x20model...'});const [_0x525824,_0x15dedf,_0x3728c6]=await Florence2Singleton[_0xf58039(0x165)](_0x10fe4d=>{const _0x35a703=_0xf58039;self[_0x35a703(0x13f)](_0x10fe4d);});self[_0xf58039(0x13f)]({'status':'loading','data':_0xf58039(0x164)});const _0x15d6fd=_0x15dedf('a'),_0x251e2d=full([0x1,0x3,0x300,0x300],0x0);await _0x525824[_0xf58039(0x160)]({..._0x15d6fd,'pixel_values':_0x251e2d,'max_new_tokens':0x1}),self[_0xf58039(0x13f)]({'status':'ready'});}const TASKS_WITH_INPUTS=[a0_0x4ef833(0x13e)];let vision_inputs,image_size;async function run({text:_0x2571f9,url:_0x4d6147,task:_0xcf8070}){const _0x4a812e=a0_0x4ef833,[_0x260ae6,_0x459de4,_0x7d5a7a]=await Florence2Singleton[_0x4a812e(0x165)](),_0x201125=performance[_0x4a812e(0x153)]();if(!vision_inputs){const _0xe43dbc=await RawImage[_0x4a812e(0x161)](_0x4d6147);image_size=_0xe43dbc[_0x4a812e(0x148)],vision_inputs=await _0x7d5a7a(_0xe43dbc);}let _0x4c567a=_0xcf8070;TASKS_WITH_INPUTS[_0x4a812e(0x143)](_0xcf8070)&&_0x2571f9&&(_0x4c567a+=_0x2571f9);const _0x435613=_0x459de4(_0x7d5a7a[_0x4a812e(0x152)](_0x4c567a)),_0x2c203b=await _0x260ae6[_0x4a812e(0x160)]({..._0x435613,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x418fbb=_0x459de4[_0x4a812e(0x155)](_0x2c203b,{'skip_special_tokens':!0x1})[0x0],_0x3d8d1f=_0x7d5a7a['post_process_generation'](_0x418fbb,_0xcf8070,image_size),_0x48e0c3=performance['now']();self[_0x4a812e(0x13f)]({'status':_0x4a812e(0x154),'result':_0x3d8d1f,'time':_0x48e0c3-_0x201125});}self['addEventListener'](a0_0x4ef833(0x14b),async _0x3a0e59=>{const _0x1d84bc=a0_0x4ef833,{type:_0x215bfd,data:_0x39411b}=_0x3a0e59['data'];switch(_0x215bfd){case _0x1d84bc(0x13d):load();break;case _0x1d84bc(0x156):run(_0x39411b);break;case'reset':vision_inputs=image_size=null;}});