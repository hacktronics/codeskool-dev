function a0_0x5ba3(_0x204c67,_0x1f9db5){const _0x2c67a6=a0_0x2c67();return a0_0x5ba3=function(_0x5ba3b4,_0x41313a){_0x5ba3b4=_0x5ba3b4-0x1c4;let _0x349108=_0x2c67a6[_0x5ba3b4];return _0x349108;},a0_0x5ba3(_0x204c67,_0x1f9db5);}const a0_0x51673c=a0_0x5ba3;(function(_0x3ebbe7,_0x614df9){const _0x3a874f=a0_0x5ba3,_0x43d69f=_0x3ebbe7();while(!![]){try{const _0x104ca3=parseInt(_0x3a874f(0x1df))/0x1*(parseInt(_0x3a874f(0x1d0))/0x2)+-parseInt(_0x3a874f(0x1e7))/0x3+-parseInt(_0x3a874f(0x1d1))/0x4+parseInt(_0x3a874f(0x1d2))/0x5+-parseInt(_0x3a874f(0x1c4))/0x6+-parseInt(_0x3a874f(0x1d3))/0x7*(parseInt(_0x3a874f(0x1de))/0x8)+parseInt(_0x3a874f(0x1c5))/0x9;if(_0x104ca3===_0x614df9)break;else _0x43d69f['push'](_0x43d69f['shift']());}catch(_0x46b61e){_0x43d69f['push'](_0x43d69f['shift']());}}}(a0_0x2c67,0x54cb0));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x4e305f=a0_0x5ba3;try{return(await navigator[_0x4e305f(0x1e2)][_0x4e305f(0x1e5)]())[_0x4e305f(0x1cd)][_0x4e305f(0x1e8)](_0x4e305f(0x1c8));}catch(_0x23432c){return!0x1;}}function a0_0x2c67(){const _0x5a4837=['535116WoGLuy','976664zXtPGq','570740StiXTV','194509FDitfX','tokenizer','generate','processor','load','size','run','fp32','message','all','data','32uDwgUv','1kGpqII','ready','from_pretrained','gpu','batch_decode','model_id','requestAdapter','<CAPTION_TO_PHRASE_GROUNDING>','1220094FUVPhu','has','getInstance','now','reset','post_process_generation','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','postMessage','228636FrcHKz','6891516hSRggC','addEventListener','Loading\x20model...','shader-f16','fp16','supports_fp16','complete','model','features','includes','loading'];a0_0x2c67=function(){return _0x5a4837;};return a0_0x2c67();}class Florence2Singleton{static ['model_id']='onnx-community/Florence-2-base-ft';static async[a0_0x51673c(0x1e9)](_0x22a164=null){const _0x28309c=a0_0x51673c;return this['processor']??=AutoProcessor[_0x28309c(0x1e1)](this['model_id']),this['tokenizer']??=AutoTokenizer[_0x28309c(0x1e1)](this[_0x28309c(0x1e4)]),this[_0x28309c(0x1ca)]??=await hasFp16(),this[_0x28309c(0x1cc)]??=Florence2ForConditionalGeneration['from_pretrained'](this['model_id'],{'dtype':{'embed_tokens':this[_0x28309c(0x1ca)]?_0x28309c(0x1c9):_0x28309c(0x1da),'vision_encoder':this['supports_fp16']?_0x28309c(0x1c9):_0x28309c(0x1da),'encoder_model':'q4','decoder_model_merged':'q4'},'device':'webgpu','progress_callback':_0x22a164}),Promise[_0x28309c(0x1dc)]([this[_0x28309c(0x1cc)],this[_0x28309c(0x1d4)],this[_0x28309c(0x1d6)]]);}}async function load(){const _0x558574=a0_0x51673c;self[_0x558574(0x1ee)]({'status':_0x558574(0x1cf),'data':_0x558574(0x1c7)});const [_0x50ed25,_0x899c90,_0x56486f]=await Florence2Singleton[_0x558574(0x1e9)](_0x98b5d5=>{const _0x7749b=_0x558574;self[_0x7749b(0x1ee)](_0x98b5d5);});self['postMessage']({'status':'loading','data':_0x558574(0x1ed)});const _0x1be79a=_0x899c90('a'),_0x14ac96=full([0x1,0x3,0x300,0x300],0x0);await _0x50ed25[_0x558574(0x1d5)]({..._0x1be79a,'pixel_values':_0x14ac96,'max_new_tokens':0x1}),self['postMessage']({'status':_0x558574(0x1e0)});}const TASKS_WITH_INPUTS=[a0_0x51673c(0x1e6)];let vision_inputs,image_size;async function run({text:_0x1b3c7b,url:_0x598034,task:_0x1fd0f5}){const _0x19c32c=a0_0x51673c,[_0x518745,_0x36cdd3,_0x337995]=await Florence2Singleton[_0x19c32c(0x1e9)](),_0x193940=performance[_0x19c32c(0x1ea)]();if(!vision_inputs){const _0x2cef31=await RawImage['fromURL'](_0x598034);image_size=_0x2cef31[_0x19c32c(0x1d8)],vision_inputs=await _0x337995(_0x2cef31);}let _0x385f6e=_0x1fd0f5;TASKS_WITH_INPUTS[_0x19c32c(0x1ce)](_0x1fd0f5)&&_0x1b3c7b&&(_0x385f6e+=_0x1b3c7b);const _0x4ce645=_0x36cdd3(_0x337995['construct_prompts'](_0x385f6e)),_0x13a364=await _0x518745[_0x19c32c(0x1d5)]({..._0x4ce645,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x5efb33=_0x36cdd3[_0x19c32c(0x1e3)](_0x13a364,{'skip_special_tokens':!0x1})[0x0],_0x9ca470=_0x337995[_0x19c32c(0x1ec)](_0x5efb33,_0x1fd0f5,image_size),_0xb2f177=performance[_0x19c32c(0x1ea)]();self[_0x19c32c(0x1ee)]({'status':_0x19c32c(0x1cb),'result':_0x9ca470,'time':_0xb2f177-_0x193940});}self[a0_0x51673c(0x1c6)](a0_0x51673c(0x1db),async _0x929160=>{const _0x1c32d0=a0_0x51673c,{type:_0x53f826,data:_0x2f39ba}=_0x929160[_0x1c32d0(0x1dd)];switch(_0x53f826){case _0x1c32d0(0x1d7):load();break;case _0x1c32d0(0x1d9):run(_0x2f39ba);break;case _0x1c32d0(0x1eb):vision_inputs=image_size=null;}});