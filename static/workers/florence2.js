const a0_0x3113c5=a0_0x350d;(function(_0xa49c30,_0x2c7a28){const _0x484b05=a0_0x350d,_0x1db809=_0xa49c30();while(!![]){try{const _0x1aa4da=-parseInt(_0x484b05(0x1df))/0x1+-parseInt(_0x484b05(0x1cf))/0x2*(parseInt(_0x484b05(0x1cc))/0x3)+parseInt(_0x484b05(0x1e0))/0x4+parseInt(_0x484b05(0x1ba))/0x5+-parseInt(_0x484b05(0x1c8))/0x6+parseInt(_0x484b05(0x1bb))/0x7+parseInt(_0x484b05(0x1d6))/0x8*(parseInt(_0x484b05(0x1e3))/0x9);if(_0x1aa4da===_0x2c7a28)break;else _0x1db809['push'](_0x1db809['shift']());}catch(_0x42ff47){_0x1db809['push'](_0x1db809['shift']());}}}(a0_0x4af6,0x9bcfa));function a0_0x350d(_0x345c18,_0x5964fd){const _0x4af665=a0_0x4af6();return a0_0x350d=function(_0x350d12,_0x4216c7){_0x350d12=_0x350d12-0x1ba;let _0x324e20=_0x4af665[_0x350d12];return _0x324e20;},a0_0x350d(_0x345c18,_0x5964fd);}import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x2003cb=a0_0x350d;try{return(await navigator[_0x2003cb(0x1be)]['requestAdapter']())['features'][_0x2003cb(0x1dc)](_0x2003cb(0x1bf));}catch(_0x2b940d){return!0x1;}}class Florence2Singleton{static [a0_0x3113c5(0x1c7)]=a0_0x3113c5(0x1d8);static async[a0_0x3113c5(0x1bd)](_0x543b77=null){const _0x92f90c=a0_0x3113c5;return this[_0x92f90c(0x1ca)]??=AutoProcessor[_0x92f90c(0x1e2)](this[_0x92f90c(0x1c7)]),this[_0x92f90c(0x1d1)]??=AutoTokenizer['from_pretrained'](this[_0x92f90c(0x1c7)]),this[_0x92f90c(0x1c9)]??=await hasFp16(),this[_0x92f90c(0x1e1)]??=Florence2ForConditionalGeneration[_0x92f90c(0x1e2)](this[_0x92f90c(0x1c7)],{'dtype':{'embed_tokens':this[_0x92f90c(0x1c9)]?_0x92f90c(0x1c0):_0x92f90c(0x1de),'vision_encoder':this[_0x92f90c(0x1c9)]?_0x92f90c(0x1c0):_0x92f90c(0x1de),'encoder_model':'q4','decoder_model_merged':'q4'},'device':_0x92f90c(0x1d5),'progress_callback':_0x543b77}),Promise[_0x92f90c(0x1c2)]([this[_0x92f90c(0x1e1)],this[_0x92f90c(0x1d1)],this['processor']]);}}async function load(){const _0x49fdc9=a0_0x3113c5;self['postMessage']({'status':'loading','data':_0x49fdc9(0x1da)});const [_0x167df3,_0x1f1871,_0x4e103d]=await Florence2Singleton[_0x49fdc9(0x1bd)](_0x1a2c94=>{const _0x86a185=_0x49fdc9;self[_0x86a185(0x1dd)](_0x1a2c94);});self['postMessage']({'status':_0x49fdc9(0x1d0),'data':_0x49fdc9(0x1cb)});const _0x49e18f=_0x1f1871('a'),_0x28f1c5=full([0x1,0x3,0x300,0x300],0x0);await _0x167df3['generate']({..._0x49e18f,'pixel_values':_0x28f1c5,'max_new_tokens':0x1}),self[_0x49fdc9(0x1dd)]({'status':'ready'});}const TASKS_WITH_INPUTS=['<CAPTION_TO_PHRASE_GROUNDING>'];let vision_inputs,image_size;async function run({text:_0x354e7a,url:_0x24cc2d,task:_0x4233d3}){const _0x42e38c=a0_0x3113c5,[_0x25ebf8,_0x37cf0e,_0x352554]=await Florence2Singleton[_0x42e38c(0x1bd)](),_0x1d393b=performance['now']();if(!vision_inputs){const _0xdd846e=await RawImage[_0x42e38c(0x1c4)](_0x24cc2d);image_size=_0xdd846e[_0x42e38c(0x1c6)],vision_inputs=await _0x352554(_0xdd846e);}let _0x444b83=_0x4233d3;TASKS_WITH_INPUTS[_0x42e38c(0x1db)](_0x4233d3)&&_0x354e7a&&(_0x444b83+=_0x354e7a);const _0x5561e2=_0x37cf0e(_0x352554[_0x42e38c(0x1d3)](_0x444b83)),_0x53af43=await _0x25ebf8[_0x42e38c(0x1bc)]({..._0x5561e2,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x1af16b=_0x37cf0e[_0x42e38c(0x1c5)](_0x53af43,{'skip_special_tokens':!0x1})[0x0],_0x40c55f=_0x352554[_0x42e38c(0x1d2)](_0x1af16b,_0x4233d3,image_size),_0x31e696=performance[_0x42e38c(0x1c3)]();self[_0x42e38c(0x1dd)]({'status':_0x42e38c(0x1d9),'result':_0x40c55f,'time':_0x31e696-_0x1d393b});}self[a0_0x3113c5(0x1d4)]('message',async _0x16850f=>{const _0x22d8cd=a0_0x3113c5,{type:_0x735270,data:_0x53fc3f}=_0x16850f[_0x22d8cd(0x1ce)];switch(_0x735270){case _0x22d8cd(0x1c1):load();break;case _0x22d8cd(0x1cd):run(_0x53fc3f);break;case _0x22d8cd(0x1d7):vision_inputs=image_size=null;}});function a0_0x4af6(){const _0x4b3ec2=['reset','onnx-community/Florence-2-base-ft','complete','Loading\x20model...','includes','has','postMessage','fp32','194345KgpsSu','3498868vwJoMt','model','from_pretrained','1728golhay','966270zwIDVl','8498210LXlBUp','generate','getInstance','gpu','shader-f16','fp16','load','all','now','fromURL','batch_decode','size','model_id','7118754FUXCMI','supports_fp16','processor','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','3LWVINL','run','data','1554726FsOHHN','loading','tokenizer','post_process_generation','construct_prompts','addEventListener','webgpu','21432ywWHjn'];a0_0x4af6=function(){return _0x4b3ec2;};return a0_0x4af6();}