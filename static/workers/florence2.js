function a0_0x1b36(_0x4bb77a,_0x2fd5f4){const _0x51c9fc=a0_0x51c9();return a0_0x1b36=function(_0x1b362f,_0x2173f3){_0x1b362f=_0x1b362f-0x186;let _0x3696e2=_0x51c9fc[_0x1b362f];return _0x3696e2;},a0_0x1b36(_0x4bb77a,_0x2fd5f4);}const a0_0x596a0e=a0_0x1b36;function a0_0x51c9(){const _0x499680=['48lUPnae','postMessage','7XlLdJM','gpu','261mEsAXJ','load','from_pretrained','post_process_generation','shader-f16','complete','fp16','40864OEUZto','797730niyeeC','13208040dSNLDH','loading','144056gGSXlo','has','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','ready','tokenizer','requestAdapter','model_id','<CAPTION_TO_PHRASE_GROUNDING>','includes','50iPtbzv','14TuNLbp','159935NkuLNe','addEventListener','batch_decode','run','message','94236fIwMhr','webgpu','onnx-community/Florence-2-base-ft','model','now','getInstance','supports_fp16','processor','348479NVxyqT','Loading\x20model...','fromURL','generate','all','fp32'];a0_0x51c9=function(){return _0x499680;};return a0_0x51c9();}(function(_0x5960b0,_0x1c2c9d){const _0x4ab92a=a0_0x1b36,_0x19f686=_0x5960b0();while(!![]){try{const _0x7e0e6=parseInt(_0x4ab92a(0x199))/0x1+parseInt(_0x4ab92a(0x18b))/0x2*(parseInt(_0x4ab92a(0x191))/0x3)+parseInt(_0x4ab92a(0x19f))/0x4*(parseInt(_0x4ab92a(0x18c))/0x5)+parseInt(_0x4ab92a(0x1ab))/0x6*(parseInt(_0x4ab92a(0x1a1))/0x7)+parseInt(_0x4ab92a(0x1aa))/0x8*(parseInt(_0x4ab92a(0x1a3))/0x9)+-parseInt(_0x4ab92a(0x18a))/0xa*(-parseInt(_0x4ab92a(0x1ae))/0xb)+-parseInt(_0x4ab92a(0x1ac))/0xc;if(_0x7e0e6===_0x1c2c9d)break;else _0x19f686['push'](_0x19f686['shift']());}catch(_0x55d47f){_0x19f686['push'](_0x19f686['shift']());}}}(a0_0x51c9,0x305d8));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x26c6b5=a0_0x1b36;try{return(await navigator[_0x26c6b5(0x1a2)][_0x26c6b5(0x186)]())['features'][_0x26c6b5(0x1af)](_0x26c6b5(0x1a7));}catch(_0x902578){return!0x1;}}class Florence2Singleton{static ['model_id']=a0_0x596a0e(0x193);static async[a0_0x596a0e(0x196)](_0x2c6af9=null){const _0x4173a3=a0_0x596a0e;return this[_0x4173a3(0x198)]??=AutoProcessor[_0x4173a3(0x1a5)](this[_0x4173a3(0x187)]),this['tokenizer']??=AutoTokenizer[_0x4173a3(0x1a5)](this[_0x4173a3(0x187)]),this[_0x4173a3(0x197)]??=await hasFp16(),this['model']??=Florence2ForConditionalGeneration[_0x4173a3(0x1a5)](this[_0x4173a3(0x187)],{'dtype':{'embed_tokens':this['supports_fp16']?_0x4173a3(0x1a9):_0x4173a3(0x19e),'vision_encoder':this[_0x4173a3(0x197)]?_0x4173a3(0x1a9):_0x4173a3(0x19e),'encoder_model':'q4','decoder_model_merged':'q4'},'device':_0x4173a3(0x192),'progress_callback':_0x2c6af9}),Promise[_0x4173a3(0x19d)]([this[_0x4173a3(0x194)],this[_0x4173a3(0x1b2)],this['processor']]);}}async function load(){const _0x42167f=a0_0x596a0e;self[_0x42167f(0x1a0)]({'status':_0x42167f(0x1ad),'data':_0x42167f(0x19a)});const [_0x3a729b,_0x22de02,_0x51ba93]=await Florence2Singleton[_0x42167f(0x196)](_0x1cc700=>{const _0x200acf=_0x42167f;self[_0x200acf(0x1a0)](_0x1cc700);});self[_0x42167f(0x1a0)]({'status':_0x42167f(0x1ad),'data':_0x42167f(0x1b0)});const _0x274b9c=_0x22de02('a'),_0x298305=full([0x1,0x3,0x300,0x300],0x0);await _0x3a729b[_0x42167f(0x19c)]({..._0x274b9c,'pixel_values':_0x298305,'max_new_tokens':0x1}),self[_0x42167f(0x1a0)]({'status':_0x42167f(0x1b1)});}const TASKS_WITH_INPUTS=[a0_0x596a0e(0x188)];let vision_inputs,image_size;async function run({text:_0x49b0ac,url:_0xdbd2b4,task:_0x4bbcf8}){const _0x30e136=a0_0x596a0e,[_0x5f2eb0,_0x32a1ad,_0x31ad57]=await Florence2Singleton[_0x30e136(0x196)](),_0x2900c9=performance[_0x30e136(0x195)]();if(!vision_inputs){const _0x16d867=await RawImage[_0x30e136(0x19b)](_0xdbd2b4);image_size=_0x16d867['size'],vision_inputs=await _0x31ad57(_0x16d867);}let _0x42bc55=_0x4bbcf8;TASKS_WITH_INPUTS[_0x30e136(0x189)](_0x4bbcf8)&&_0x49b0ac&&(_0x42bc55+=_0x49b0ac);const _0xf20f7c=_0x32a1ad(_0x31ad57['construct_prompts'](_0x42bc55)),_0x5b9482=await _0x5f2eb0['generate']({..._0xf20f7c,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x57a66e=_0x32a1ad[_0x30e136(0x18e)](_0x5b9482,{'skip_special_tokens':!0x1})[0x0],_0x26b5f2=_0x31ad57[_0x30e136(0x1a6)](_0x57a66e,_0x4bbcf8,image_size),_0xd28005=performance[_0x30e136(0x195)]();self[_0x30e136(0x1a0)]({'status':_0x30e136(0x1a8),'result':_0x26b5f2,'time':_0xd28005-_0x2900c9});}self[a0_0x596a0e(0x18d)](a0_0x596a0e(0x190),async _0x197c4f=>{const _0x321e39=a0_0x596a0e,{type:_0x3414fd,data:_0x5716ce}=_0x197c4f['data'];switch(_0x3414fd){case _0x321e39(0x1a4):load();break;case _0x321e39(0x18f):run(_0x5716ce);break;case'reset':vision_inputs=image_size=null;}});