const a0_0x336060=a0_0x1238;(function(_0x503cab,_0x5f24d9){const _0x24f241=a0_0x1238,_0x1a3282=_0x503cab();while(!![]){try{const _0x5cd680=-parseInt(_0x24f241(0x1d5))/0x1+-parseInt(_0x24f241(0x1d8))/0x2*(parseInt(_0x24f241(0x1b3))/0x3)+parseInt(_0x24f241(0x1cd))/0x4*(-parseInt(_0x24f241(0x1ba))/0x5)+-parseInt(_0x24f241(0x1b5))/0x6*(-parseInt(_0x24f241(0x1d0))/0x7)+-parseInt(_0x24f241(0x1d2))/0x8*(-parseInt(_0x24f241(0x1c0))/0x9)+parseInt(_0x24f241(0x1c1))/0xa*(-parseInt(_0x24f241(0x1c4))/0xb)+-parseInt(_0x24f241(0x1b8))/0xc*(-parseInt(_0x24f241(0x1d7))/0xd);if(_0x5cd680===_0x5f24d9)break;else _0x1a3282['push'](_0x1a3282['shift']());}catch(_0x285bde){_0x1a3282['push'](_0x1a3282['shift']());}}}(a0_0x3d81,0xedc73));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0xbe33e1=a0_0x1238;try{return(await navigator[_0xbe33e1(0x1c5)][_0xbe33e1(0x1bb)]())[_0xbe33e1(0x1b0)][_0xbe33e1(0x1b1)](_0xbe33e1(0x1b4));}catch(_0x4bc609){return!0x1;}}class Florence2Singleton{static [a0_0x336060(0x1b9)]=a0_0x336060(0x1c3);static async['getInstance'](_0x49c927=null){const _0x3f68d9=a0_0x336060;return this[_0x3f68d9(0x1c6)]??=AutoProcessor[_0x3f68d9(0x1d6)](this['model_id']),this['tokenizer']??=AutoTokenizer[_0x3f68d9(0x1d6)](this[_0x3f68d9(0x1b9)]),this[_0x3f68d9(0x1be)]??=await hasFp16(),this[_0x3f68d9(0x1af)]??=Florence2ForConditionalGeneration[_0x3f68d9(0x1d6)](this[_0x3f68d9(0x1b9)],{'dtype':{'embed_tokens':this[_0x3f68d9(0x1be)]?_0x3f68d9(0x1cc):_0x3f68d9(0x1d3),'vision_encoder':this[_0x3f68d9(0x1be)]?_0x3f68d9(0x1cc):_0x3f68d9(0x1d3),'encoder_model':'q4','decoder_model_merged':'q4'},'device':_0x3f68d9(0x1bc),'progress_callback':_0x49c927}),Promise['all']([this[_0x3f68d9(0x1af)],this['tokenizer'],this['processor']]);}}async function load(){const _0xd72efb=a0_0x336060;self[_0xd72efb(0x1b2)]({'status':'loading','data':_0xd72efb(0x1b6)});const [_0xb73990,_0x355eaa,_0x3f6430]=await Florence2Singleton[_0xd72efb(0x1d4)](_0x283b93=>{const _0x3eb376=_0xd72efb;self[_0x3eb376(0x1b2)](_0x283b93);});self[_0xd72efb(0x1b2)]({'status':'loading','data':_0xd72efb(0x1c9)});const _0x4ea168=_0x355eaa('a'),_0x59faac=full([0x1,0x3,0x300,0x300],0x0);await _0xb73990['generate']({..._0x4ea168,'pixel_values':_0x59faac,'max_new_tokens':0x1}),self[_0xd72efb(0x1b2)]({'status':_0xd72efb(0x1ad)});}function a0_0x3d81(){const _0x11b7e2=['9796480VfQqfl','generate','onnx-community/Florence-2-base-ft','11ABQdya','gpu','processor','reset','now','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','run','size','fp16','60qicGiK','construct_prompts','batch_decode','7YQoASn','load','474840LjGMdL','fp32','getInstance','1087633daYvTW','from_pretrained','10751sYcdSb','154NWxpSh','data','ready','complete','model','features','has','postMessage','26853ybeure','shader-f16','6225426RRlzod','Loading\x20model...','message','57696zMInhL','model_id','645415BgUeOE','requestAdapter','webgpu','<CAPTION_TO_PHRASE_GROUNDING>','supports_fp16','fromURL','99tDNQuD'];a0_0x3d81=function(){return _0x11b7e2;};return a0_0x3d81();}const TASKS_WITH_INPUTS=[a0_0x336060(0x1bd)];function a0_0x1238(_0x435aed,_0x56bd8e){const _0x3d8163=a0_0x3d81();return a0_0x1238=function(_0x1238b5,_0x40686a){_0x1238b5=_0x1238b5-0x1ac;let _0x3f3636=_0x3d8163[_0x1238b5];return _0x3f3636;},a0_0x1238(_0x435aed,_0x56bd8e);}let vision_inputs,image_size;async function run({text:_0x10f3d2,url:_0x1e156d,task:_0x2b24f8}){const _0x38d4da=a0_0x336060,[_0x207f97,_0x505715,_0xf1362e]=await Florence2Singleton['getInstance'](),_0xb1cb23=performance[_0x38d4da(0x1c8)]();if(!vision_inputs){const _0x2d140d=await RawImage[_0x38d4da(0x1bf)](_0x1e156d);image_size=_0x2d140d[_0x38d4da(0x1cb)],vision_inputs=await _0xf1362e(_0x2d140d);}let _0x158b73=_0x2b24f8;TASKS_WITH_INPUTS['includes'](_0x2b24f8)&&_0x10f3d2&&(_0x158b73+=_0x10f3d2);const _0x46b226=_0x505715(_0xf1362e[_0x38d4da(0x1ce)](_0x158b73)),_0x542471=await _0x207f97[_0x38d4da(0x1c2)]({..._0x46b226,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x205a07=_0x505715[_0x38d4da(0x1cf)](_0x542471,{'skip_special_tokens':!0x1})[0x0],_0x4739de=_0xf1362e['post_process_generation'](_0x205a07,_0x2b24f8,image_size),_0x506f9c=performance['now']();self[_0x38d4da(0x1b2)]({'status':_0x38d4da(0x1ae),'result':_0x4739de,'time':_0x506f9c-_0xb1cb23});}self['addEventListener'](a0_0x336060(0x1b7),async _0x572f0a=>{const _0x59f684=a0_0x336060,{type:_0x3cf7d0,data:_0x25c94c}=_0x572f0a[_0x59f684(0x1ac)];switch(_0x3cf7d0){case _0x59f684(0x1d1):load();break;case _0x59f684(0x1ca):run(_0x25c94c);break;case _0x59f684(0x1c7):vision_inputs=image_size=null;}});