function a0_0x5b8f(){const _0x1c0e7e=['fromURL','processor','1465ctAFQR','has','930330LSDpRw','<CAPTION_TO_PHRASE_GROUNDING>','features','from_pretrained','3514320WnHuRu','model_id','getInstance','run','gpu','994402xmiAzo','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','message','23712VySEty','Loading\x20model...','requestAdapter','2919301BYTWcn','construct_prompts','model','addEventListener','7601848zBKwJw','fp32','includes','batch_decode','postMessage','now','1298823qamnqR','loading','supports_fp16','16mtFuQu','reset','load','data','fp16','onnx-community/Florence-2-base-ft','shader-f16','all'];a0_0x5b8f=function(){return _0x1c0e7e;};return a0_0x5b8f();}const a0_0x50e368=a0_0x3e39;(function(_0x169550,_0x2114e4){const _0x19b68c=a0_0x3e39,_0x1a33ff=_0x169550();while(!![]){try{const _0x233680=-parseInt(_0x19b68c(0x190))/0x1+-parseInt(_0x19b68c(0x199))/0x2+parseInt(_0x19b68c(0x181))/0x3*(parseInt(_0x19b68c(0x184))/0x4)+parseInt(_0x19b68c(0x18e))/0x5*(-parseInt(_0x19b68c(0x19c))/0x6)+parseInt(_0x19b68c(0x19f))/0x7+parseInt(_0x19b68c(0x1a3))/0x8+parseInt(_0x19b68c(0x194))/0x9;if(_0x233680===_0x2114e4)break;else _0x1a33ff['push'](_0x1a33ff['shift']());}catch(_0x46a4cd){_0x1a33ff['push'](_0x1a33ff['shift']());}}}(a0_0x5b8f,0xdcb73));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x99fcda=a0_0x3e39;try{return(await navigator[_0x99fcda(0x198)][_0x99fcda(0x19e)]())[_0x99fcda(0x192)][_0x99fcda(0x18f)](_0x99fcda(0x18a));}catch(_0x334a25){return!0x1;}}function a0_0x3e39(_0x3b2071,_0x33d8f6){const _0x5b8f3a=a0_0x5b8f();return a0_0x3e39=function(_0x3e39f0,_0x534374){_0x3e39f0=_0x3e39f0-0x17f;let _0x2ea432=_0x5b8f3a[_0x3e39f0];return _0x2ea432;},a0_0x3e39(_0x3b2071,_0x33d8f6);}class Florence2Singleton{static [a0_0x50e368(0x195)]=a0_0x50e368(0x189);static async[a0_0x50e368(0x196)](_0x47b501=null){const _0x1116ee=a0_0x50e368;return this[_0x1116ee(0x18d)]??=AutoProcessor[_0x1116ee(0x193)](this[_0x1116ee(0x195)]),this['tokenizer']??=AutoTokenizer['from_pretrained'](this['model_id']),this[_0x1116ee(0x183)]??=await hasFp16(),this[_0x1116ee(0x1a1)]??=Florence2ForConditionalGeneration[_0x1116ee(0x193)](this[_0x1116ee(0x195)],{'dtype':{'embed_tokens':this[_0x1116ee(0x183)]?'fp16':_0x1116ee(0x1a4),'vision_encoder':this['supports_fp16']?_0x1116ee(0x188):_0x1116ee(0x1a4),'encoder_model':'q4','decoder_model_merged':'q4'},'device':'webgpu','progress_callback':_0x47b501}),Promise[_0x1116ee(0x18b)]([this[_0x1116ee(0x1a1)],this['tokenizer'],this[_0x1116ee(0x18d)]]);}}async function load(){const _0x2da3f9=a0_0x50e368;self[_0x2da3f9(0x17f)]({'status':_0x2da3f9(0x182),'data':_0x2da3f9(0x19d)});const [_0x470ad6,_0x25a00c,_0x36ff8b]=await Florence2Singleton[_0x2da3f9(0x196)](_0x474fc3=>{const _0x236d41=_0x2da3f9;self[_0x236d41(0x17f)](_0x474fc3);});self[_0x2da3f9(0x17f)]({'status':_0x2da3f9(0x182),'data':_0x2da3f9(0x19a)});const _0x119e6d=_0x25a00c('a'),_0x3f17fc=full([0x1,0x3,0x300,0x300],0x0);await _0x470ad6['generate']({..._0x119e6d,'pixel_values':_0x3f17fc,'max_new_tokens':0x1}),self[_0x2da3f9(0x17f)]({'status':'ready'});}const TASKS_WITH_INPUTS=[a0_0x50e368(0x191)];let vision_inputs,image_size;async function run({text:_0x39bbdf,url:_0x1dbb03,task:_0x563547}){const _0x48529d=a0_0x50e368,[_0x2b3624,_0x13652f,_0x4d6d71]=await Florence2Singleton['getInstance'](),_0x37a97f=performance[_0x48529d(0x180)]();if(!vision_inputs){const _0x19b30b=await RawImage[_0x48529d(0x18c)](_0x1dbb03);image_size=_0x19b30b['size'],vision_inputs=await _0x4d6d71(_0x19b30b);}let _0x33eb90=_0x563547;TASKS_WITH_INPUTS[_0x48529d(0x1a5)](_0x563547)&&_0x39bbdf&&(_0x33eb90+=_0x39bbdf);const _0xa64510=_0x13652f(_0x4d6d71[_0x48529d(0x1a0)](_0x33eb90)),_0xcedf07=await _0x2b3624['generate']({..._0xa64510,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x3f96ab=_0x13652f[_0x48529d(0x1a6)](_0xcedf07,{'skip_special_tokens':!0x1})[0x0],_0x2ca5a6=_0x4d6d71['post_process_generation'](_0x3f96ab,_0x563547,image_size),_0x4ec691=performance[_0x48529d(0x180)]();self[_0x48529d(0x17f)]({'status':'complete','result':_0x2ca5a6,'time':_0x4ec691-_0x37a97f});}self[a0_0x50e368(0x1a2)](a0_0x50e368(0x19b),async _0x240021=>{const _0x4c6cae=a0_0x50e368,{type:_0x215c11,data:_0x4a9b24}=_0x240021[_0x4c6cae(0x187)];switch(_0x215c11){case _0x4c6cae(0x186):load();break;case _0x4c6cae(0x197):run(_0x4a9b24);break;case _0x4c6cae(0x185):vision_inputs=image_size=null;}});