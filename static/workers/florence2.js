const a0_0x2ca0e7=a0_0x3f89;(function(_0x434508,_0x5f404a){const _0x1c7e19=a0_0x3f89,_0x238fb2=_0x434508();while(!![]){try{const _0x11d52a=-parseInt(_0x1c7e19(0xe2))/0x1*(-parseInt(_0x1c7e19(0xe6))/0x2)+parseInt(_0x1c7e19(0xf5))/0x3+-parseInt(_0x1c7e19(0xde))/0x4+-parseInt(_0x1c7e19(0xf1))/0x5+-parseInt(_0x1c7e19(0xdc))/0x6*(parseInt(_0x1c7e19(0xfb))/0x7)+parseInt(_0x1c7e19(0xef))/0x8+parseInt(_0x1c7e19(0xeb))/0x9;if(_0x11d52a===_0x5f404a)break;else _0x238fb2['push'](_0x238fb2['shift']());}catch(_0x13a01b){_0x238fb2['push'](_0x238fb2['shift']());}}}(a0_0x3be7,0xdf10e));function a0_0x3f89(_0x45c550,_0x4bb2b7){const _0x3be798=a0_0x3be7();return a0_0x3f89=function(_0x3f89e1,_0x108725){_0x3f89e1=_0x3f89e1-0xd8;let _0x3db7f4=_0x3be798[_0x3f89e1];return _0x3db7f4;},a0_0x3f89(_0x45c550,_0x4bb2b7);}import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x2ab1f5=a0_0x3f89;try{return(await navigator[_0x2ab1f5(0xdb)][_0x2ab1f5(0xff)]())[_0x2ab1f5(0xed)][_0x2ab1f5(0xdd)](_0x2ab1f5(0xfc));}catch(_0x190f16){return!0x1;}}class Florence2Singleton{static [a0_0x2ca0e7(0xe3)]=a0_0x2ca0e7(0xe8);static async[a0_0x2ca0e7(0xf3)](_0x8db176=null){const _0x1bf178=a0_0x2ca0e7;return this[_0x1bf178(0xf8)]??=AutoProcessor[_0x1bf178(0xfa)](this[_0x1bf178(0xe3)]),this[_0x1bf178(0xf6)]??=AutoTokenizer[_0x1bf178(0xfa)](this[_0x1bf178(0xe3)]),this[_0x1bf178(0xf4)]??=await hasFp16(),this[_0x1bf178(0xdf)]??=Florence2ForConditionalGeneration[_0x1bf178(0xfa)](this[_0x1bf178(0xe3)],{'dtype':{'embed_tokens':this[_0x1bf178(0xf4)]?_0x1bf178(0x101):_0x1bf178(0xe7),'vision_encoder':this[_0x1bf178(0xf4)]?_0x1bf178(0x101):_0x1bf178(0xe7),'encoder_model':'q4','decoder_model_merged':'q4'},'device':_0x1bf178(0xe9),'progress_callback':_0x8db176}),Promise[_0x1bf178(0xd8)]([this['model'],this[_0x1bf178(0xf6)],this[_0x1bf178(0xf8)]]);}}async function load(){const _0xb1acd7=a0_0x2ca0e7;self[_0xb1acd7(0x102)]({'status':_0xb1acd7(0xf9),'data':_0xb1acd7(0xf2)});const [_0x535f0a,_0x36f807,_0x4a972a]=await Florence2Singleton[_0xb1acd7(0xf3)](_0x1d82d4=>{self['postMessage'](_0x1d82d4);});self[_0xb1acd7(0x102)]({'status':_0xb1acd7(0xf9),'data':_0xb1acd7(0xe5)});const _0x5ea92e=_0x36f807('a'),_0x5a5267=full([0x1,0x3,0x300,0x300],0x0);await _0x535f0a[_0xb1acd7(0xfe)]({..._0x5ea92e,'pixel_values':_0x5a5267,'max_new_tokens':0x1}),self[_0xb1acd7(0x102)]({'status':_0xb1acd7(0x100)});}function a0_0x3be7(){const _0x59dd7e=['2KNPMwJ','fp32','onnx-community/Florence-2-base-ft','webgpu','now','8399376SpuBTt','includes','features','batch_decode','7068928IbhRkh','size','3280605AwRhAo','Loading\x20model...','getInstance','supports_fp16','2751861OvOouf','tokenizer','run','processor','loading','from_pretrained','497pwttEF','shader-f16','message','generate','requestAdapter','ready','fp16','postMessage','all','<CAPTION_TO_PHRASE_GROUNDING>','reset','gpu','22494OSMFSa','has','7002528WfzSmN','model','construct_prompts','complete','852443dhTwWA','model_id','post_process_generation','Compiling\x20shaders\x20and\x20warming\x20up\x20model...'];a0_0x3be7=function(){return _0x59dd7e;};return a0_0x3be7();}const TASKS_WITH_INPUTS=[a0_0x2ca0e7(0xd9)];let vision_inputs,image_size;async function run({text:_0x442888,url:_0x38b8b9,task:_0x5892a9}){const _0x4a98df=a0_0x2ca0e7,[_0xe20206,_0x191610,_0x1534d0]=await Florence2Singleton[_0x4a98df(0xf3)](),_0x522b7e=performance[_0x4a98df(0xea)]();if(!vision_inputs){const _0x56add7=await RawImage['fromURL'](_0x38b8b9);image_size=_0x56add7[_0x4a98df(0xf0)],vision_inputs=await _0x1534d0(_0x56add7);}let _0x507b6d=_0x5892a9;TASKS_WITH_INPUTS[_0x4a98df(0xec)](_0x5892a9)&&_0x442888&&(_0x507b6d+=_0x442888);const _0x143016=_0x191610(_0x1534d0[_0x4a98df(0xe0)](_0x507b6d)),_0x32895e=await _0xe20206['generate']({..._0x143016,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x166974=_0x191610[_0x4a98df(0xee)](_0x32895e,{'skip_special_tokens':!0x1})[0x0],_0x2fb34f=_0x1534d0[_0x4a98df(0xe4)](_0x166974,_0x5892a9,image_size),_0xf79c2c=performance[_0x4a98df(0xea)]();self[_0x4a98df(0x102)]({'status':_0x4a98df(0xe1),'result':_0x2fb34f,'time':_0xf79c2c-_0x522b7e});}self['addEventListener'](a0_0x2ca0e7(0xfd),async _0x2e30f6=>{const _0x2c1027=a0_0x2ca0e7,{type:_0xf35112,data:_0x338f2f}=_0x2e30f6['data'];switch(_0xf35112){case'load':load();break;case _0x2c1027(0xf7):run(_0x338f2f);break;case _0x2c1027(0xda):vision_inputs=image_size=null;}});