function a0_0x35fe(_0x3ee0a8,_0x4e378f){const _0x238894=a0_0x2388();return a0_0x35fe=function(_0x35fe5b,_0x36165a){_0x35fe5b=_0x35fe5b-0xcc;let _0x1ad5c8=_0x238894[_0x35fe5b];return _0x1ad5c8;},a0_0x35fe(_0x3ee0a8,_0x4e378f);}const a0_0x4f40c3=a0_0x35fe;(function(_0x281800,_0x99d1b6){const _0x131b2f=a0_0x35fe,_0x2d9852=_0x281800();while(!![]){try{const _0x5b674c=-parseInt(_0x131b2f(0xe9))/0x1+-parseInt(_0x131b2f(0xdf))/0x2*(parseInt(_0x131b2f(0xef))/0x3)+-parseInt(_0x131b2f(0xd9))/0x4+parseInt(_0x131b2f(0xe4))/0x5+-parseInt(_0x131b2f(0xdc))/0x6+parseInt(_0x131b2f(0xdd))/0x7*(parseInt(_0x131b2f(0xd8))/0x8)+-parseInt(_0x131b2f(0xeb))/0x9*(-parseInt(_0x131b2f(0xce))/0xa);if(_0x5b674c===_0x99d1b6)break;else _0x2d9852['push'](_0x2d9852['shift']());}catch(_0x554785){_0x2d9852['push'](_0x2d9852['shift']());}}}(a0_0x2388,0x55f09));import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x57ba85=a0_0x35fe;try{return(await navigator[_0x57ba85(0xe2)][_0x57ba85(0xd3)]())[_0x57ba85(0xee)]['has']('shader-f16');}catch(_0x2c1d42){return!0x1;}}class Florence2Singleton{static [a0_0x4f40c3(0xe8)]=a0_0x4f40c3(0xcf);static async[a0_0x4f40c3(0xe0)](_0x2bea72=null){const _0x2857e3=a0_0x4f40c3;return this[_0x2857e3(0xda)]??=AutoProcessor[_0x2857e3(0xed)](this[_0x2857e3(0xe8)]),this[_0x2857e3(0xdb)]??=AutoTokenizer[_0x2857e3(0xed)](this[_0x2857e3(0xe8)]),this['supports_fp16']??=await hasFp16(),this['model']??=Florence2ForConditionalGeneration[_0x2857e3(0xed)](this[_0x2857e3(0xe8)],{'dtype':{'embed_tokens':this[_0x2857e3(0xd0)]?_0x2857e3(0xf0):_0x2857e3(0xd1),'vision_encoder':this['supports_fp16']?_0x2857e3(0xf0):_0x2857e3(0xd1),'encoder_model':'q4','decoder_model_merged':'q4'},'device':'webgpu','progress_callback':_0x2bea72}),Promise[_0x2857e3(0xe1)]([this['model'],this['tokenizer'],this[_0x2857e3(0xda)]]);}}async function load(){const _0x4d97b2=a0_0x4f40c3;self[_0x4d97b2(0xf1)]({'status':_0x4d97b2(0xd2),'data':_0x4d97b2(0xd7)});const [_0x4336b5,_0x274331,_0x21387a]=await Florence2Singleton[_0x4d97b2(0xe0)](_0x3c24ba=>{self['postMessage'](_0x3c24ba);});self['postMessage']({'status':_0x4d97b2(0xd2),'data':'Compiling\x20shaders\x20and\x20warming\x20up\x20model...'});const _0x17b748=_0x274331('a'),_0x51b4a0=full([0x1,0x3,0x300,0x300],0x0);await _0x4336b5[_0x4d97b2(0xe5)]({..._0x17b748,'pixel_values':_0x51b4a0,'max_new_tokens':0x1}),self[_0x4d97b2(0xf1)]({'status':_0x4d97b2(0xde)});}const TASKS_WITH_INPUTS=[a0_0x4f40c3(0xd4)];function a0_0x2388(){const _0x4f30ab=['loading','requestAdapter','<CAPTION_TO_PHRASE_GROUNDING>','size','data','Loading\x20model...','11336nweEAi','2179324EntYRs','processor','tokenizer','3950532xFbipm','3129wLJECr','ready','9916ZzthFq','getInstance','all','gpu','addEventListener','674105TYShKT','generate','construct_prompts','includes','model_id','551886ASlzcl','batch_decode','202608BXyazX','post_process_generation','from_pretrained','features','48pykUMa','fp16','postMessage','reset','run','630ZgSBkk','onnx-community/Florence-2-base-ft','supports_fp16','fp32'];a0_0x2388=function(){return _0x4f30ab;};return a0_0x2388();}let vision_inputs,image_size;async function run({text:_0x1f95fe,url:_0x2fb71a,task:_0x47eba8}){const _0x14d8fa=a0_0x4f40c3,[_0x17fa54,_0x21eea3,_0x586d04]=await Florence2Singleton[_0x14d8fa(0xe0)](),_0x4bd8b0=performance['now']();if(!vision_inputs){const _0x21ddc9=await RawImage['fromURL'](_0x2fb71a);image_size=_0x21ddc9[_0x14d8fa(0xd5)],vision_inputs=await _0x586d04(_0x21ddc9);}let _0x26aaa8=_0x47eba8;TASKS_WITH_INPUTS[_0x14d8fa(0xe7)](_0x47eba8)&&_0x1f95fe&&(_0x26aaa8+=_0x1f95fe);const _0xd54bde=_0x21eea3(_0x586d04[_0x14d8fa(0xe6)](_0x26aaa8)),_0x47c3d0=await _0x17fa54['generate']({..._0xd54bde,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0xe8cc38=_0x21eea3[_0x14d8fa(0xea)](_0x47c3d0,{'skip_special_tokens':!0x1})[0x0],_0x20f442=_0x586d04[_0x14d8fa(0xec)](_0xe8cc38,_0x47eba8,image_size),_0x30b77b=performance['now']();self[_0x14d8fa(0xf1)]({'status':'complete','result':_0x20f442,'time':_0x30b77b-_0x4bd8b0});}self[a0_0x4f40c3(0xe3)]('message',async _0x566855=>{const _0x19e990=a0_0x4f40c3,{type:_0x247f78,data:_0x1fd8b6}=_0x566855[_0x19e990(0xd6)];switch(_0x247f78){case'load':load();break;case _0x19e990(0xcd):run(_0x1fd8b6);break;case _0x19e990(0xcc):vision_inputs=image_size=null;}});