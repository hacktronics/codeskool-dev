function a0_0x4fac(_0x14ecdd,_0x405e0f){const _0x3bc1f8=a0_0x3bc1();return a0_0x4fac=function(_0x4facda,_0x1f5b68){_0x4facda=_0x4facda-0x12b;let _0x15ccb7=_0x3bc1f8[_0x4facda];return _0x15ccb7;},a0_0x4fac(_0x14ecdd,_0x405e0f);}const a0_0x53e8fb=a0_0x4fac;(function(_0x930323,_0x456a97){const _0x1d5c39=a0_0x4fac,_0x3f2e3b=_0x930323();while(!![]){try{const _0x5c7782=parseInt(_0x1d5c39(0x12d))/0x1*(parseInt(_0x1d5c39(0x151))/0x2)+-parseInt(_0x1d5c39(0x13d))/0x3*(parseInt(_0x1d5c39(0x132))/0x4)+-parseInt(_0x1d5c39(0x14b))/0x5*(-parseInt(_0x1d5c39(0x139))/0x6)+parseInt(_0x1d5c39(0x12e))/0x7+parseInt(_0x1d5c39(0x138))/0x8*(parseInt(_0x1d5c39(0x14f))/0x9)+parseInt(_0x1d5c39(0x12c))/0xa+-parseInt(_0x1d5c39(0x14d))/0xb;if(_0x5c7782===_0x456a97)break;else _0x3f2e3b['push'](_0x3f2e3b['shift']());}catch(_0x482d34){_0x3f2e3b['push'](_0x3f2e3b['shift']());}}}(a0_0x3bc1,0xbb7fc));function a0_0x3bc1(){const _0x3d9ce1=['4xRXCsT','data','batch_decode','model','now','tokenizer','683680PrTBHM','4038BKhEPc','generate','gpu','model_id','3143949LIWptD','from_pretrained','post_process_generation','shader-f16','Compiling\x20shaders\x20and\x20warming\x20up\x20model...','fp32','onnx-community/Florence-2-base-ft','getInstance','has','supports_fp16','includes','fromURL','complete','construct_prompts','565xdzgWX','run','15798453GzJYkv','processor','45IZIcVG','<CAPTION_TO_PHRASE_GROUNDING>','4DEitAw','size','reset','2422460fxKwmF','746913OhzLtV','7089467CfdfBo','features','Loading\x20model...','postMessage'];a0_0x3bc1=function(){return _0x3d9ce1;};return a0_0x3bc1();}import{Florence2ForConditionalGeneration,AutoProcessor,AutoTokenizer,RawImage,full}from'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.4.0/dist/transformers.min.js';async function hasFp16(){const _0x2c1a08=a0_0x4fac;try{return(await navigator[_0x2c1a08(0x13b)]['requestAdapter']())[_0x2c1a08(0x12f)][_0x2c1a08(0x145)](_0x2c1a08(0x140));}catch(_0x411add){return!0x1;}}class Florence2Singleton{static [a0_0x53e8fb(0x13c)]=a0_0x53e8fb(0x143);static async[a0_0x53e8fb(0x144)](_0xd956fa=null){const _0x2f8c19=a0_0x53e8fb;return this[_0x2f8c19(0x14e)]??=AutoProcessor[_0x2f8c19(0x13e)](this[_0x2f8c19(0x13c)]),this[_0x2f8c19(0x137)]??=AutoTokenizer['from_pretrained'](this[_0x2f8c19(0x13c)]),this['supports_fp16']??=await hasFp16(),this[_0x2f8c19(0x135)]??=Florence2ForConditionalGeneration[_0x2f8c19(0x13e)](this[_0x2f8c19(0x13c)],{'dtype':{'embed_tokens':this[_0x2f8c19(0x146)]?'fp16':_0x2f8c19(0x142),'vision_encoder':this['supports_fp16']?'fp16':_0x2f8c19(0x142),'encoder_model':'q4','decoder_model_merged':'q4'},'device':'webgpu','progress_callback':_0xd956fa}),Promise['all']([this[_0x2f8c19(0x135)],this[_0x2f8c19(0x137)],this[_0x2f8c19(0x14e)]]);}}async function load(){const _0x5de6b1=a0_0x53e8fb;self['postMessage']({'status':'loading','data':_0x5de6b1(0x130)});const [_0x397bec,_0x26799d,_0x2f37b8]=await Florence2Singleton[_0x5de6b1(0x144)](_0x53d7bc=>{const _0x4424ed=_0x5de6b1;self[_0x4424ed(0x131)](_0x53d7bc);});self['postMessage']({'status':'loading','data':_0x5de6b1(0x141)});const _0x45dc7a=_0x26799d('a'),_0x5a3079=full([0x1,0x3,0x300,0x300],0x0);await _0x397bec[_0x5de6b1(0x13a)]({..._0x45dc7a,'pixel_values':_0x5a3079,'max_new_tokens':0x1}),self['postMessage']({'status':'ready'});}const TASKS_WITH_INPUTS=[a0_0x53e8fb(0x150)];let vision_inputs,image_size;async function run({text:_0x58422c,url:_0x2b53f8,task:_0x4f5c9b}){const _0x14bb47=a0_0x53e8fb,[_0xc3833b,_0x8d9981,_0x1d0223]=await Florence2Singleton[_0x14bb47(0x144)](),_0x3d03a2=performance[_0x14bb47(0x136)]();if(!vision_inputs){const _0x4c6b40=await RawImage[_0x14bb47(0x148)](_0x2b53f8);image_size=_0x4c6b40[_0x14bb47(0x152)],vision_inputs=await _0x1d0223(_0x4c6b40);}let _0x6d9f1a=_0x4f5c9b;TASKS_WITH_INPUTS[_0x14bb47(0x147)](_0x4f5c9b)&&_0x58422c&&(_0x6d9f1a+=_0x58422c);const _0x2e64e3=_0x8d9981(_0x1d0223[_0x14bb47(0x14a)](_0x6d9f1a)),_0x49bd00=await _0xc3833b['generate']({..._0x2e64e3,...vision_inputs,'max_new_tokens':0x80,'num_beams':0x1,'do_sample':!0x1}),_0x58ff31=_0x8d9981[_0x14bb47(0x134)](_0x49bd00,{'skip_special_tokens':!0x1})[0x0],_0x3ca8c2=_0x1d0223[_0x14bb47(0x13f)](_0x58ff31,_0x4f5c9b,image_size),_0xa963d5=performance[_0x14bb47(0x136)]();self[_0x14bb47(0x131)]({'status':_0x14bb47(0x149),'result':_0x3ca8c2,'time':_0xa963d5-_0x3d03a2});}self['addEventListener']('message',async _0x2d88b4=>{const _0x40eba1=a0_0x53e8fb,{type:_0x32adb6,data:_0x2cebb0}=_0x2d88b4[_0x40eba1(0x133)];switch(_0x32adb6){case'load':load();break;case _0x40eba1(0x14c):run(_0x2cebb0);break;case _0x40eba1(0x12b):vision_inputs=image_size=null;}});